<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vehicle Sales 2025 - Strategic Operations</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Charts -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #020205;
            color: #e2e8f0;
            transition: background-color 0.3s, color 0.3s;
        }
        .font-mono {
            font-family: 'JetBrains Mono', monospace;
        }
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #0f172a; 
        }
        ::-webkit-scrollbar-thumb {
            background: #334155; 
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #475569; 
        }
        
        /* Animations */
        @keyframes tilt {
            0%, 50%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(1deg); }
            75% { transform: rotate(-1deg); }
        }
        .animate-tilt {
            animation: tilt 5s infinite linear;
        }
        
        .glass-panel {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: background-color 0.3s, border-color 0.3s;
        }

        /* ApexCharts Tooltip Customization - Dark Default */
        .apexcharts-tooltip {
            background: rgba(15, 23, 42, 0.9) !important;
            border: 1px solid #475569 !important;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5) !important;
            color: #fff !important;
            border-radius: 0.5rem !important;
        }
        .apexcharts-tooltip-title {
            background: rgba(30, 41, 59, 0.8) !important;
            border-bottom: 1px solid #475569 !important;
            font-family: 'JetBrains Mono', monospace !important;
        }
        .apexcharts-text {
            fill: #94a3b8 !important;
        }
        .apexcharts-gridline {
            stroke: #1e293b !important;
        }
        .apexcharts-legend-text {
            color: #cbd5e1 !important;
        }

        /* --- Light Mode Overrides --- */
        body.light-mode {
            background-color: #f1f5f9; /* Slate 100 */
            color: #1e293b; /* Slate 800 */
        }
        body.light-mode .glass-panel {
            background: rgba(255, 255, 255, 0.7);
            border: 1px solid rgba(203, 213, 225, 0.6);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }
        body.light-mode nav {
            background: rgba(255, 255, 255, 0.85) !important;
            border-bottom: 1px solid rgba(226, 232, 240, 0.8);
        }
        body.light-mode .text-white { color: #0f172a !important; } /* Invert key white text to dark */
        body.light-mode .text-slate-300 { color: #334155 !important; }
        body.light-mode .text-slate-400 { color: #64748b !important; }
        body.light-mode .text-slate-500 { color: #64748b !important; }
        
        /* Adjust contrast for specific elements in light mode */
        body.light-mode .bg-black { background-color: #ffffff !important; border: 1px solid #e2e8f0; color: #0f172a; }
        body.light-mode .bg-black\/40 { background-color: rgba(255, 255, 255, 0.5) !important; border: 1px solid #cbd5e1; }
        body.light-mode .bg-white\/5 { background-color: rgba(0, 0, 0, 0.05) !important; }
        body.light-mode .bg-white\/10 { background-color: rgba(0, 0, 0, 0.1) !important; }
        body.light-mode .border-white\/5 { border-color: rgba(0, 0, 0, 0.05) !important; }
        body.light-mode .border-white\/10 { border-color: rgba(0, 0, 0, 0.1) !important; }
        body.light-mode .border-white\/20 { border-color: rgba(0, 0, 0, 0.2) !important; }
        
        /* Chart overrides for light mode */
        body.light-mode .apexcharts-text { fill: #475569 !important; }
        body.light-mode .apexcharts-gridline { stroke: #e2e8f0 !important; }
        body.light-mode .apexcharts-legend-text { color: #334155 !important; }
        body.light-mode .apexcharts-tooltip {
            background: #ffffff !important;
            border: 1px solid #e2e8f0 !important;
            color: #0f172a !important;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1) !important;
        }
        body.light-mode .apexcharts-tooltip-title {
            background: #f8fafc !important;
            border-bottom: 1px solid #e2e8f0 !important;
        }
    </style>
</head>
<body class="overflow-x-hidden">

    <!-- Background Effects -->
    <div class="fixed inset-0 pointer-events-none bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20 brightness-100 contrast-150 mix-blend-overlay z-0"></div>
    <div class="fixed inset-0 pointer-events-none z-0" 
         style="background-image: linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px); background-size: 40px 40px;">
    </div>
    <div class="fixed inset-0 pointer-events-none z-0">
        <div class="absolute top-[-20%] left-[-10%] w-[50%] h-[50%] bg-indigo-900/20 rounded-full blur-[120px] transition-colors duration-700 light-blob"></div>
        <div class="absolute bottom-[-20%] right-[-10%] w-[50%] h-[50%] bg-fuchsia-900/20 rounded-full blur-[120px] transition-colors duration-700 light-blob"></div>
    </div>

    <!-- App Container -->
    <div class="w-full mx-auto relative z-10">
        
        <!-- Navbar -->
        <nav class="sticky top-0 z-40 glass-panel shadow-2xl border-b-0 transition-all duration-300">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-16">
                    <div class="flex items-center space-x-3">
                        <div class="relative group cursor-pointer">
                            <div class="absolute -inset-1 bg-gradient-to-r from-fuchsia-600 via-purple-600 to-blue-600 rounded-lg blur opacity-40 group-hover:opacity-100 transition duration-500 animate-tilt"></div>
                            <div class="relative bg-black p-2 rounded-lg border border-white/10">
                                <i data-lucide="layout-dashboard" class="w-5 h-5 text-white"></i>
                            </div>
                        </div>
                        <div class="flex flex-col">
                            <span class="text-lg font-bold tracking-tight text-white font-mono">
                                VEHICLE SALES <span class="text-fuchsia-500">2025</span>
                            </span>
                            <span class="text-[9px] text-slate-500 uppercase tracking-[0.2em]">Strategic Operations</span>
                        </div>
                    </div>
                    
                    <div class="flex items-center space-x-3">
                        <!-- Theme Toggle -->
                        <button onclick="toggleTheme()" class="flex items-center justify-center w-8 h-8 rounded-lg bg-white/5 border border-white/10 text-slate-300 hover:text-white hover:bg-white/10 transition-all" title="Toggle Theme">
                            <i data-lucide="moon" class="w-4 h-4" id="themeIcon"></i>
                        </button>

                        <button onclick="toggleReportModal()" class="hidden md:flex items-center space-x-2 px-3 py-1.5 rounded-lg bg-white/5 border border-white/10 text-indigo-300 hover:bg-indigo-500/20 hover:border-indigo-500/50 transition-all group">
                            <i data-lucide="file-text" class="w-4 h-4 group-hover:text-white transition-colors"></i>
                            <span class="text-xs font-medium">Briefing</span>
                        </button>

                        <button onclick="exportCSV()" class="hidden md:flex items-center space-x-2 px-3 py-1.5 rounded-lg bg-white/5 border border-white/10 text-emerald-300 hover:bg-emerald-500/20 hover:border-emerald-500/50 transition-all group">
                            <i data-lucide="download" class="w-4 h-4 group-hover:text-white transition-colors"></i>
                            <span class="text-xs font-medium">Export</span>
                        </button>

                        <button onclick="toggleFilters()" id="filterBtn" class="flex items-center space-x-2 px-3 py-1.5 rounded-lg border border-white/10 bg-white/5 text-slate-300 hover:bg-white/10 transition-all">
                            <i data-lucide="filter" class="w-4 h-4"></i>
                            <span class="text-xs font-medium hidden md:inline">Filter View</span>
                            <span id="activeFilterIndicator" class="flex h-2 w-2 rounded-full bg-fuchsia-500 animate-pulse hidden"></span>
                        </button>

                        <button onclick="toggleAI()" class="flex items-center space-x-2 bg-gradient-to-r from-fuchsia-600 to-indigo-600 text-white px-4 py-1.5 rounded-lg border border-white/10 shadow-lg shadow-fuchsia-900/20 transition-all hover:shadow-fuchsia-900/40 hover:scale-105 group">
                            <i data-lucide="sparkles" class="w-4 h-4 group-hover:animate-spin"></i>
                            <span class="text-xs font-bold hidden md:inline">AI ANALYST</span>
                        </button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Filter Bar -->
        <div id="filterPanel" class="border-b border-white/5 bg-[#050511]/90 backdrop-blur-md transition-all duration-500 overflow-hidden max-h-0 opacity-0">
            <div class="max-w-7xl mx-auto px-4 py-6">
                <div class="flex flex-wrap gap-6 items-start">
                    <!-- Year Filter -->
                    <div class="flex flex-col space-y-2">
                        <label class="text-[10px] text-fuchsia-400 uppercase tracking-widest font-bold flex items-center gap-2">
                            <i data-lucide="calendar" class="w-3 h-3"></i> Fiscal Year
                        </label>
                        <div class="flex flex-wrap gap-1" id="yearFilters"></div>
                    </div>
                    
                    <!-- Region Filter -->
                    <div class="flex flex-col space-y-2">
                        <label class="text-[10px] text-blue-400 uppercase tracking-widest font-bold flex items-center gap-2">
                            <i data-lucide="map" class="w-3 h-3"></i> Region
                        </label>
                        <div class="flex flex-wrap gap-1" id="regionFilters"></div>
                    </div>

                    <!-- Size Filter -->
                    <div class="flex flex-col space-y-2">
                        <label class="text-[10px] text-emerald-400 uppercase tracking-widest font-bold flex items-center gap-2">
                            <i data-lucide="target" class="w-3 h-3"></i> Deal Size
                        </label>
                        <div class="flex flex-wrap gap-1" id="sizeFilters"></div>
                    </div>

                    <!-- Product Filter -->
                    <div class="flex flex-col space-y-2">
                        <label class="text-[10px] text-purple-400 uppercase tracking-widest font-bold flex items-center gap-2">
                            <i data-lucide="layers" class="w-3 h-3"></i> Product
                        </label>
                        <div class="flex flex-wrap gap-1" id="productFilters"></div>
                    </div>

                    <!-- Reset -->
                    <button onclick="resetFilters()" class="ml-auto mt-6 text-xs text-red-400 hover:text-white hover:bg-red-500/20 px-3 py-1.5 rounded-md border border-transparent hover:border-red-500/50 transition-all flex items-center">
                        <i data-lucide="refresh-cw" class="w-3 h-3 mr-2"></i> Reset
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-8 relative z-10">
            
            <!-- KPI Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6" id="kpiGrid">
                <!-- KPIs injected by JS -->
            </div>

            <!-- Main Chart Section -->
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
                <!-- Revenue Velocity Chart -->
                <div class="lg:col-span-8 glass-panel rounded-2xl p-6 shadow-2xl relative group overflow-hidden">
                    <div class="absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-fuchsia-500 to-transparent opacity-50"></div>
                    <div class="flex flex-wrap items-center justify-between mb-4 relative z-10">
                        <div>
                            <h3 class="text-xl font-bold text-white flex items-center gap-2 font-mono tracking-tight">
                                <i data-lucide="zap" class="w-5 h-5 text-yellow-400 fill-current"></i> REVENUE VELOCITY
                            </h3>
                            <p class="text-[10px] text-slate-400 font-mono mt-1 flex items-center gap-2 uppercase tracking-wider">
                                <span class="flex h-1.5 w-1.5 rounded-full bg-emerald-500 animate-pulse shadow-[0_0_10px_#10b981]"></span> Live Data Stream
                            </p>
                        </div>
                        <div class="flex items-center gap-1 bg-black/40 p-1 rounded-lg border border-white/10 backdrop-blur-sm">
                            <button onclick="setChartType('area')" id="btnArea" class="p-2 rounded-md transition-all bg-slate-700/80 text-white shadow-md"><i data-lucide="activity" class="w-4 h-4"></i></button>
                            <button onclick="setChartType('bar')" id="btnBar" class="p-2 rounded-md transition-all text-slate-500 hover:text-slate-300"><i data-lucide="bar-chart-2" class="w-4 h-4"></i></button>
                        </div>
                    </div>
                    <div id="revenueChart" class="w-full h-[350px]"></div>
                </div>

                <!-- Right Column -->
                <div class="lg:col-span-4 space-y-6">
                    <!-- Top Customers -->
                    <div class="glass-panel rounded-2xl p-6 h-[250px] relative flex flex-col">
                        <div class="flex justify-between items-center mb-2">
                            <h3 class="text-sm font-bold text-slate-300 uppercase tracking-wider flex items-center gap-2 font-mono">
                                <i data-lucide="users" class="w-4 h-4 text-fuchsia-500"></i> VIP Clients
                            </h3>
                        </div>
                        <div id="customerChart" class="flex-1 w-full"></div>
                    </div>

                    <!-- Region Pie -->
                    <div class="glass-panel rounded-2xl p-6 h-[220px] relative flex flex-col overflow-hidden">
                        <div class="flex justify-between items-center mb-2 relative z-10">
                            <h3 class="text-sm font-bold text-slate-300 uppercase tracking-wider flex items-center gap-2 font-mono">
                                <i data-lucide="map" class="w-4 h-4 text-blue-500"></i> Territory Share
                            </h3>
                            <span class="text-[9px] bg-blue-500/10 text-blue-300 px-2 py-0.5 rounded border border-blue-500/20 uppercase tracking-wider animate-pulse">Interactive</span>
                        </div>
                        <div id="regionChart" class="flex-1 w-full relative z-10 cursor-pointer"></div>
                        <div class="absolute bottom-0 right-0 w-24 h-24 bg-blue-600/10 blur-2xl rounded-full"></div>
                    </div>
                </div>
            </div>

            <!-- Bottom Section -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Product Mix -->
                <div class="glass-panel rounded-2xl p-6">
                    <div class="flex justify-between items-center mb-2">
                        <h3 class="text-lg font-bold text-white flex items-center gap-2 font-mono">
                            <i data-lucide="layers" class="w-5 h-5 text-purple-500"></i> PRODUCT MIX
                        </h3>
                        <span class="text-[10px] text-slate-500 font-mono bg-white/5 px-2 py-1 rounded">SELECT SLICE TO FILTER</span>
                    </div>
                    <div id="productChart" class="w-full h-[300px] cursor-pointer"></div>
                </div>

                <!-- Transaction Ledger -->
                <div class="glass-panel rounded-2xl p-6 flex flex-col">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-bold text-white flex items-center gap-2 font-mono">
                            <i data-lucide="table" class="w-5 h-5 text-emerald-500"></i> TRANSACTION LEDGER
                        </h3>
                        <span id="recordCount" class="px-2 py-1 bg-emerald-500/10 border border-emerald-500/20 rounded text-[10px] text-emerald-400 font-mono">0 RECORDS</span>
                    </div>
                    <div class="flex-1 overflow-auto max-h-[300px]">
                        <table class="w-full text-left border-collapse">
                            <thead>
                                <tr class="text-[10px] text-slate-500 font-mono uppercase border-b border-slate-800/50 sticky top-0 bg-[#0f172a] z-10" id="ledgerHeader">
                                    <th class="pb-3 pl-2 font-semibold">Date</th>
                                    <th class="pb-3 font-semibold">Product</th>
                                    <th class="pb-3 font-semibold">Region</th>
                                    <th class="pb-3 font-semibold text-right">Amount</th>
                                    <th class="pb-3 font-semibold text-right">Profit</th>
                                    <th class="pb-3 text-right">Status</th>
                                    <th class="pb-3 pr-2 text-right">Intel</th>
                                </tr>
                            </thead>
                            <tbody id="ledgerBody" class="text-sm text-slate-300 font-mono">
                                <!-- Rows injected via JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>

        <!-- AI Sidebar -->
        <div id="aiSidebar" class="fixed inset-y-0 right-0 w-full md:w-[400px] bg-[#050511]/95 backdrop-blur-xl border-l border-white/10 shadow-2xl transform translate-x-full transition-transform duration-300 z-50 flex flex-col font-mono text-sm absolute h-full">
            <div class="p-4 border-b border-white/10 flex justify-between items-center bg-black/40">
                <div class="flex items-center space-x-2 text-fuchsia-400">
                    <i data-lucide="brain-circuit" class="w-5 h-5"></i>
                    <h2 class="font-bold tracking-wider">KARTIK PROJECT AI</h2>
                </div>
                <div class="flex items-center space-x-3">
                    <button onclick="clearHistory()" class="text-[10px] text-slate-500 hover:text-white uppercase tracking-widest">Purge</button>
                    <button onclick="toggleAI()"><i data-lucide="x" class="w-5 h-5 text-slate-400 hover:text-white"></i></button>
                </div>
            </div>
            
            <div id="chatHistory" class="flex-1 overflow-y-auto p-4 space-y-4">
                <!-- Chat messages -->
            </div>

            <!-- Quick Actions -->
            <div class="px-4 py-2 bg-black/20 flex gap-2 overflow-x-auto scrollbar-hide" id="quickActions">
                <!-- Buttons injected -->
            </div>

            <div class="p-4 bg-black/20 border-t border-white/10 space-y-3">
                <div class="relative">
                    <input type="text" id="aiInput" placeholder="Input Command..." class="w-full bg-black/50 border border-slate-700 text-white rounded-lg pl-4 pr-10 py-3 focus:border-fuchsia-500 focus:ring-1 focus:ring-fuchsia-500 outline-none transition-all placeholder:text-slate-700" onkeydown="if(event.key === 'Enter') handleAiSend()">
                    <button onclick="handleAiSend()" class="absolute right-2 top-2 p-1.5 text-fuchsia-500 hover:text-white"><i data-lucide="send" class="w-4 h-4"></i></button>
                </div>
            </div>
        </div>

        <!-- AI Report Modal -->
        <div id="reportModal" class="fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm hidden opacity-0 transition-opacity duration-300 absolute h-full">
            <div class="bg-[#0f172a] w-full max-w-2xl max-h-[85vh] rounded-2xl border border-slate-700 shadow-2xl flex flex-col overflow-hidden transform scale-95 transition-transform duration-300" id="reportContentBox">
                <div class="p-4 border-b border-slate-700 flex justify-between items-center bg-slate-900/50">
                    <div class="flex items-center space-x-3">
                        <div class="p-2 bg-indigo-600/20 rounded-lg"><i data-lucide="file-text" class="w-5 h-5 text-indigo-400"></i></div>
                        <div>
                            <h3 class="text-white font-bold">AI Executive Briefing</h3>
                            <p class="text-xs text-slate-400">Generated by Gemini Pro & Imagen 3</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button onclick="copyReport()" class="p-2 hover:bg-white/5 rounded-lg text-slate-400 hover:text-white transition-colors"><i data-lucide="copy" class="w-4 h-4"></i></button>
                        <button onclick="toggleReportModal()" class="p-2 hover:bg-white/5 rounded-lg text-slate-400 hover:text-white transition-colors"><i data-lucide="x" class="w-5 h-5"></i></button>
                    </div>
                </div>
                <div id="reportBody" class="flex-1 overflow-y-auto bg-slate-900/30 relative">
                    <!-- Content goes here -->
                </div>
                <div class="p-4 border-t border-slate-700 bg-slate-900/50 flex justify-end">
                    <button onclick="toggleReportModal()" class="px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg text-sm font-medium transition-colors">Close Report</button>
                </div>
            </div>
        </div>

    </div>

    <!-- Scripts -->
    <script>
        // --- THEME LOGIC ---
        function toggleTheme() {
            document.body.classList.toggle('light-mode');
            const isLight = document.body.classList.contains('light-mode');
            const themeIcon = document.getElementById('themeIcon');
            
            // Update Icon
            themeIcon.setAttribute('data-lucide', isLight ? 'sun' : 'moon');
            lucide.createIcons();

            // Update Charts
            const mode = isLight ? 'light' : 'dark';
            if(revenueChart) revenueChart.updateOptions({ theme: { mode: mode } });
            if(customerChart) customerChart.updateOptions({ theme: { mode: mode } });
            
            // Region and Product charts need more granular text update as Apex doesn't auto-swap all colors in custom configs
            // But the CSS overrides handles most text. We trigger a redraw.
            if(regionChart) regionChart.updateOptions({ theme: { mode: mode } });
            if(productChart) productChart.updateOptions({ theme: { mode: mode } });
        }

        // --- DATA ---
        const API_KEY = "AIzaSyAc3qmoim9BBs9MXe7RLFOTjSMsRMpvpdw"; // Centralized API key (consider securing server-side)
        const RAW_DATA = [
  {year: 2003.0, month: '2003-01', product: 'Classic Cars', region: 'EMEA', country: 'Finland', size: 'Medium', status: 'Shipped', sales: 11084.8, profit: 3879.68, orders: 3, daysToShip: 3.3}, 
  {year: 2003.0, month: '2003-01', product: 'Classic Cars', region: 'EMEA', country: 'Finland', size: 'Small', status: 'Shipped', sales: 1977.63, profit: 692.17, orders: 2, daysToShip: 1.5}, 
  {year: 2003.0, month: '2003-01', product: 'Classic Cars', region: 'EMEA', country: 'France', size: 'Large', status: 'Shipped', sales: 4800.0, profit: 1680.0, orders: 1, daysToShip: 7.0}, 
  {year: 2003.0, month: '2003-01', product: 'Classic Cars', region: 'EMEA', country: 'France', size: 'Medium', status: 'Shipped', sales: 7300.0, profit: 2555.0, orders: 2, daysToShip: 3.5}, 
  {year: 2003.0, month: '2003-01', product: 'Classic Cars', region: 'EMEA', country: 'Norway', size: 'Medium', status: 'Shipped', sales: 11000.0, profit: 3850.0, orders: 3, daysToShip: 4.7}, 
  {year: 2003.0, month: '2003-01', product: 'Classic Cars', region: 'EMEA', country: 'Spain', size: 'Medium', status: 'Shipped', sales: 11900.0, profit: 4165.0, orders: 4, daysToShip: 4.2}, 
  {year: 2003.0, month: '2003-01', product: 'Classic Cars', region: 'NA', country: 'USA', size: 'Large', status: 'Shipped', sales: 8363.66, profit: 2927.28, orders: 1, daysToShip: 2.0}, 
  {year: 2003.0, month: '2003-01', product: 'Classic Cars', region: 'NA', country: 'USA', size: 'Medium', status: 'Shipped', sales: 33953.04, profit: 11883.56, orders: 10, daysToShip: 4.1}, 
  {year: 2003.0, month: '2003-01', product: 'Classic Cars', region: 'NA', country: 'USA', size: 'Small', status: 'Shipped', sales: 12053.72, profit: 4218.8, orders: 6, daysToShip: 3.5}, 
  {year: 2003.0, month: '2003-01', product: 'Motorcycles', region: 'EMEA', country: 'France', size: 'Medium', status: 'Shipped', sales: 3884.34, profit: 1359.52, orders: 1, daysToShip: 1.0}, 
  {year: 2003.0, month: '2003-01', product: 'Motorcycles', region: 'EMEA', country: 'Norway', size: 'Medium', status: 'Shipped', sales: 3730.96, profit: 1305.84, orders: 1, daysToShip: 7.0}, 
  {year: 2003.0, month: '2003-01', product: 'Planes', region: 'EMEA', country: 'Finland', size: 'Medium', status: 'Shipped', sales: 7229.4, profit: 2530.29, orders: 2, daysToShip: 4.0}, 
  {year: 2003.0, month: '2003-01', product: 'Ships', region: 'EMEA', country: 'Spain', size: 'Medium', status: 'Shipped', sales: 6300.22, profit: 2205.08, orders: 2, daysToShip: 4.5}, 
  {year: 2003.0, month: '2003-01', product: 'Trains', region: 'EMEA', country: 'Spain', size: 'Small', status: 'Shipped', sales: 1667.46, profit: 583.61, orders: 1, daysToShip: 5.0}, 
  {year: 2003.0, month: '2003-01', product: 'Trucks and Buses', region: 'EMEA', country: 'Finland', size: 'Medium', status: 'Shipped', sales: 9603.22, profit: 3361.13, orders: 2, daysToShip: 4.5}, 
  {year: 2003.0, month: '2003-01', product: 'Trucks and Buses', region: 'EMEA', country: 'Spain', size: 'Medium', status: 'Shipped', sales: 10373.73, profit: 3630.81, orders: 3, daysToShip: 3.3}, 
  {year: 2003.0, month: '2003-01', product: 'Vintage Cars', region: 'APAC', country: 'Philippines', size: 'Medium', status: 'Shipped', sales: 6433.48, profit: 2251.72, orders: 2, daysToShip: 4.5}, 
  {year: 2003.0, month: '2003-01', product: 'Vintage Cars', region: 'EMEA', country: 'Spain', size: 'Medium', status: 'Shipped', sales: 26193.22, profit: 9167.63, orders: 7, daysToShip: 4.3}, 
  {year: 2003.0, month: '2003-02', product: 'Classic Cars', region: 'EMEA', country: 'Denmark', size: 'Large', status: 'Shipped', sales: 9258.6, profit: 3240.51, orders: 1, daysToShip: 1.0}, 
  {year: 2003.0, month: '2003-02', product: 'Classic Cars', region: 'EMEA', country: 'Denmark', size: 'Medium', status: 'Shipped', sales: 25807.74, profit: 9032.71, orders: 7, daysToShip: 4.4}, 
  {year: 2003.0, month: '2003-02', product: 'Classic Cars', region: 'NA', country: 'USA', size: 'Medium', status: 'Shipped', sales: 42570.36, profit: 14899.63, orders: 12, daysToShip: 3.8}, 
  {year: 2003.0, month: '2003-02', product: 'Motorcycles', region: 'NA', country: 'USA', size: 'Small', status: 'Shipped', sales: 2871.0, profit: 1004.85, orders: 1, daysToShip: 2.0}, 
  {year: 2003.0, month: '2003-03', product: 'Classic Cars', region: 'APAC', country: 'Singapore', size: 'Large', status: 'Shipped', sales: 8430.24, profit: 2950.58, orders: 1, daysToShip: 5.0}, 
  {year: 2003.0, month: '2003-03', product: 'Classic Cars', region: 'APAC', country: 'Singapore', size: 'Medium', status: 'Shipped', sales: 21748.36, profit: 7611.93, orders: 7, daysToShip: 4.1}, 
  {year: 2003.0, month: '2003-04', product: 'Classic Cars', region: 'EMEA', country: 'UK', size: 'Medium', status: 'Shipped', sales: 18200.0, profit: 6370.0, orders: 5, daysToShip: 3.0}, 
  {year: 2003.0, month: '2003-05', product: 'Trucks and Buses', region: 'APAC', country: 'Australia', size: 'Large', status: 'Shipped', sales: 7800.0, profit: 2730.0, orders: 1, daysToShip: 2.0}, 
  {year: 2003.0, month: '2003-06', product: 'Vintage Cars', region: 'EMEA', country: 'France', size: 'Medium', status: 'Shipped', sales: 12000.0, profit: 4200.0, orders: 3, daysToShip: 3.0}, 
  {year: 2003.0, month: '2003-07', product: 'Motorcycles', region: 'EMEA', country: 'France', size: 'Small', status: 'Shipped', sales: 2765.9, profit: 968.06, orders: 1, daysToShip: 6.0}, 
  {year: 2003.0, month: '2003-08', product: 'Motorcycles', region: 'NA', country: 'USA', size: 'Medium', status: 'Shipped', sales: 3746.7, profit: 1311.35, orders: 1, daysToShip: 4.0}, 
  {year: 2003.0, month: '2003-09', product: 'Classic Cars', region: 'NA', country: 'USA', size: 'Large', status: 'Shipped', sales: 15000.0, profit: 5250.0, orders: 2, daysToShip: 2.0}, 
  {year: 2003.0, month: '2003-10', product: 'Motorcycles', region: 'NA', country: 'USA', size: 'Medium', status: 'Shipped', sales: 4900.0, profit: 1715.0, orders: 1, daysToShip: 1.0}, 
  {year: 2003.0, month: '2003-11', product: 'Classic Cars', region: 'NA', country: 'USA', size: 'Large', status: 'Shipped', sales: 48000.0, profit: 16800.0, orders: 6, daysToShip: 2.5}, 
  {year: 2003.0, month: '2003-12', product: 'Vintage Cars', region: 'NA', country: 'USA', size: 'Medium', status: 'Shipped', sales: 22000.0, profit: 7700.0, orders: 5, daysToShip: 3.2}, 
  {year: 2003.0, month: '2003-01', product: 'Vintage Cars', region: 'EMEA', country: 'Norway', size: 'Small', status: 'Shipped', sales: 11192.88, profit: 3917.51, orders: 5, daysToShip: 5.6}, 
  {year: 2003.0, month: '2003-01', product: 'Vintage Cars', region: 'EMEA', country: 'Norway', size: 'Medium', status: 'Shipped', sales: 4600.0, profit: 1610.0, orders: 1, daysToShip: 2.0}, 
  {year: 2003.0, month: '2003-01', product: 'Trucks and Buses', region: 'EMEA', country: 'Spain', size: 'Small', status: 'Shipped', sales: 1666.7, profit: 583.34, orders: 1, daysToShip: 4.0}, 
  {year: 2003.0, month: '2003-01', product: 'Trucks and Buses', region: 'EMEA', country: 'Spain', size: 'Medium', status: 'Shipped', sales: 10300.0, profit: 3605.0, orders: 3, daysToShip: 3.7}, 
  {year: 2003.0, month: '2003-01', product: 'Trucks and Buses', region: 'EMEA', country: 'Norway', size: 'Small', status: 'Shipped', sales: 1189.98, profit: 416.49, orders: 1, daysToShip: 3.0}, 
  {year: 2003.0, month: '2003-01', product: 'Trucks and Buses', region: 'EMEA', country: 'Norway', size: 'Medium', status: 'Shipped', sales: 19903.35, profit: 6966.17, orders: 6, daysToShip: 3.8}, 
  {year: 2003.0, month: '2003-01', product: 'Trucks and Buses', region: 'EMEA', country: 'France', size: 'Small', status: 'Shipped', sales: 3660.44, profit: 1281.15, orders: 2, daysToShip: 5.5}, 
  {year: 2003.0, month: '2003-01', product: 'Trucks and Buses', region: 'EMEA', country: 'France', size: 'Medium', status: 'Shipped', sales: 14290.15, profit: 5001.55, orders: 4, daysToShip: 4.2}, 
  {year: 2003.0, month: '2003-01', product: 'Trucks and Buses', region: 'EMEA', country: 'Finland', size: 'Small', status: 'Shipped', sales: 3203.76, profit: 1121.32, orders: 2, daysToShip: 3.0}, 
  {year: 2003.0, month: '2003-01', product: 'Trucks and Buses', region: 'EMEA', country: 'Finland', size: 'Medium', 'status': 'Shipped', 'sales': 9100.0, 'profit': 3185.0, 'orders': 2, 'daysToShip': 4.0}, 
  {year: 2003.0, month: '2003-01', product: 'Trains', region: 'EMEA', country: 'Spain', 'size': 'Small', 'status': 'Shipped', 'sales': 1705.92, 'profit': 597.07, 'orders': 1, 'daysToShip': 6.0}, 
  {year: 2003.0, month: '2003-01', product: 'Trains', region: 'EMEA', country: 'Spain', 'size': 'Medium', 'status': 'Shipped', 'sales': 3227.63, 'profit': 1129.67, 'orders': 1, 'daysToShip': 5.0}, 
  {year: 2003.0, month: '2003-01', product: 'Planes', region: 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 7120.96, 'profit': 2492.34, 'orders': 2, 'daysToShip': 5.5}, 
  {year: 2003.0, month: '2003-01', product: 'Vintage Cars', region: 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 1113.6, 'profit': 389.76, 'orders': 1, 'daysToShip': 6.0}, 
  {year: 2003.0, month: '2003-01', product: 'Motorcycles', region: 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 8800.0, 'profit': 3080.0, 'orders': 3, 'daysToShip': 2.0}, 
  {year: 2003.0, month: '2003-01', product: 'Motorcycles', region: 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 5959.84, 'profit': 2085.94, 'orders': 3, 'daysToShip': 3.7}, 
  {year: 2003.0, month: '2003-01', product: 'Classic Cars', region: 'EMEA', 'country': 'France', 'size': 'Medium', 'status': 'Shipped', 'sales': 7300.0, 'profit': 2555.0, 'orders': 2, 'daysToShip': 1.5}, 
  {year: 2003.0, month: '2003-01', product: 'Classic Cars', region: 'EMEA', 'country': 'France', 'size': 'Small', 'status': 'Shipped', 'sales': 721.44, 'profit': 252.5, 'orders': 1, 'daysToShip': 1.0}, 
  {year: 2003.0, month: '2003-01', product: 'Classic Cars', region: 'EMEA', 'country': 'Norway', 'size': 'Medium', 'status': 'Shipped', 'sales': 11000.0, 'profit': 3850.0, 'orders': 3, 'daysToShip': 2.3}, 
  {year: 2003.0, month: '2003-01', product: 'Classic Cars', region: 'EMEA', 'country': 'Spain', 'size': 'Small', 'status': 'Shipped', 'sales': 6284.55, 'profit': 2199.59, 'orders': 3, 'daysToShip': 4.3}, 
  {year: 2003.0, month: '2003-01', product: 'Motorcycles', region: 'EMEA', 'country': 'France', 'size': 'Large', 'status': 'Shipped', 'sales': 3100.0, 'profit': 1085.0, 'orders': 1, 'daysToShip': 7.0}, 
  {year: 2003.0, month: '2003-01', product: 'Motorcycles', region: 'EMEA', 'country': 'France', 'size': 'Medium', 'status': 'Shipped', 'sales': 13428.53, 'profit': 4699.99, 'orders': 4, 'daysToShip': 3.8}, 
  {year: 2003.0, month: '2003-01', product: 'Motorcycles', region: 'EMEA', 'country': 'France', 'size': 'Small', 'status': 'Shipped', 'sales': 3853.4, 'profit': 1348.69, 'orders': 2, 'daysToShip': 2.0}, 
  {year: 2003.0, month: '2003-01', product: 'Motorcycles', region: 'NA', 'country': 'USA', 'size': 'Large', 'status': 'Shipped', 'sales': 4900.0, 'profit': 1715.0, 'orders': 1, 'daysToShip': 6.0}, 
  {year: 2003.0, month: '2003-02', product: 'Vintage Cars', region: 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 8247.47, 'profit': 2886.61, 'orders': 4, 'daysToShip': 4.0}, 
  {year: 2003.0, month: '2003-02', product: 'Vintage Cars', region: 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 5900.0, 'profit': 2065.0, 'orders': 2, 'daysToShip': 4.0}, 
  {year: 2003.0, month: '2003-02', product: 'Vintage Cars', region: 'EMEA', 'country': 'Italy', 'size': 'Small', 'status': 'Shipped', 'sales': 5602.81, 'profit': 1960.98, 'orders': 3, 'daysToShip': 5.7}, 
  {year: 2003.0, month: '2003-02', product: 'Vintage Cars', region: 'EMEA', 'country': 'Italy', 'size': 'Medium', 'status': 'Shipped', 'sales': 4100.0, 'profit': 1435.0, 'orders': 1, 'daysToShip': 4.0}, 
  {year: 2003.0, month: '2003-02', product: 'Ships', region: 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 2315.88, 'profit': 810.56, 'orders': 1, 'daysToShip': 7.0}, 
  {year: 2003.0, month: '2003-02', product: 'Ships', region: 'EMEA', 'country': 'Italy', 'size': 'Medium', 'status': 'Shipped', 'sales': 6421.04, 'profit': 2247.36, 'orders': 2, 'daysToShip': 4.0}, 
  {year: 2003.0, month: '2003-02', product: 'Planes', region: 'EMEA', 'country': 'Italy', 'size': 'Small', 'status': 'Shipped', 'sales': 9615.24, 'profit': 3365.33, 'orders': 4, 'daysToShip': 4.0}, 
  {year: 2003.0, month: '2003-02', product: 'Planes', region: 'EMEA', 'country': 'Italy', 'size': 'Medium', 'status': 'Shipped', 'sales': 26547.68, 'profit': 9291.69, 'orders': 8, 'daysToShip': 4.5}, 
  {year: 2003.0, month: '2003-02', product: 'Motorcycles', region: 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 16075.63, 'profit': 5626.47, 'orders': 5, 'daysToShip': 4.2}, 
  {year: 2003.0, month: '2003-02', product: 'Classic Cars', region: 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 12640.94, 'profit': 4424.33, 'orders': 7, 'daysToShip': 4.9}, 
  {year: 2003.0, month: '2003-02', product: 'Classic Cars', region: 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 62029.38, 'profit': 21710.28, 'orders': 16, 'daysToShip': 4.4}, 
  {year: 2003.0, month: '2003-02', product: 'Classic Cars', region: 'NA', 'country': 'USA', 'size': 'Large', 'status': 'Shipped', 'sales': 4200.0, 'profit': 1470.0, 'orders': 1, 'daysToShip': 2.0}, 
  {year: 2003.0, month: '2003-02', product: 'Classic Cars', 'region': 'EMEA', 'country': 'Spain', 'size': 'Small', 'status': 'Shipped', 'sales': 7822.92, 'profit': 2738.02, 'orders': 4, 'daysToShip': 2.8}, 
  {year: 2003.0, month: '2003-02', product: 'Classic Cars', 'region': 'EMEA', 'country': 'Spain', 'size': 'Medium', 'status': 'Shipped', 'sales': 22097.71, 'profit': 7734.2, 'orders': 6, 'daysToShip': 2.8}, 
  {year: 2003.0, month: '2003-02', product: 'Motorcycles', 'region': 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 17359.58, 'profit': 6075.85, 'orders': 8, 'daysToShip': 3.5}, 
  {year: 2003.0, month: '2003-03', product: 'Trucks and Buses', 'region': 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 6313.71, 'profit': 2209.8, 'orders': 3, 'daysToShip': 4.0}, 
  {year: 2003.0, month: '2003-03', product: 'Vintage Cars', 'region': 'EMEA', 'country': 'Spain', 'size': 'Large', 'status': 'Shipped', 'sales': 4000.0, 'profit': 1400.0, 'orders': 1, 'daysToShip': 2.0}, 
  {year: 2003.0, month: '2003-03', product: 'Vintage Cars', 'region': 'EMEA', 'country': 'Spain', 'size': 'Medium', 'status': 'Shipped', 'sales': 6653.28, 'profit': 2328.65, 'orders': 2, 'daysToShip': 4.5}, 
  {year: 2003.0, month: '2003-03', product: 'Vintage Cars', 'region': 'EMEA', 'country': 'Spain', 'size': 'Small', 'status': 'Shipped', 'sales': 2103.36, 'profit': 736.18, 'orders': 2, 'daysToShip': 4.0}, 
  {year: 2003.0, month: '2003-03', product: 'Vintage Cars', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 11488.78, 'profit': 4021.07, 'orders': 3, 'daysToShip': 6.3}, 
  {year: 2003.0, month: '2003-03', product: 'Vintage Cars', 'region': 'EMEA', 'country': 'UK', 'size': 'Medium', 'status': 'Shipped', 'sales': 10600.0, 'profit': 3710.0, 'orders': 3, 'daysToShip': 4.7}, 
  {year: 2003.0, month: '2003-03', 'product': 'Vintage Cars', 'region': 'EMEA', 'country': 'UK', 'size': 'Small', 'status': 'Shipped', 'sales': 8201.97, 'profit': 2870.69, 'orders': 5, 'daysToShip': 3.0}, 
  {year: 2003.0, month: '2003-03', 'product': 'Vintage Cars', 'region': 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 8900.3, 'profit': 3115.1, 'orders': 4, 'daysToShip': 5.2}, 
  {year: 2003.0, month: '2003-03', 'product': 'Trucks and Buses', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 16100.0, 'profit': 5635.0, 'orders': 4, 'daysToShip': 5.5}, 
  {year: 2003.0, month: '2003-03', 'product': 'Vintage Cars', 'region': 'EMEA', 'country': 'Sweden', 'size': 'Small', 'status': 'Shipped', 'sales': 2300.0, 'profit': 805.0, 'orders': 1, 'daysToShip': 5.0}, 
  {year: 2003.0, month: '2003-03', 'product': 'Trains', 'region': 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 2054.36, 'profit': 719.03, 'orders': 1, 'daysToShip': 2.0}, 
  {year: 2003.0, month: '2003-03', 'product': 'Trains', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 3179.52, 'profit': 1112.83, 'orders': 1, 'daysToShip': 5.0}, 
  {year: 2003.0, month: '2003-03', 'product': 'Motorcycles', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 3155.58, 'profit': 1104.45, 'orders': 1, 'daysToShip': 5.0}, 
  {year: 2003.0, month: '2003-03', 'product': 'Classic Cars', 'region': 'EMEA', 'country': 'Sweden', 'size': 'Large', 'status': 'Shipped', 'sales': 2900.0, 'profit': 1015.0, 'orders': 1, 'daysToShip': 6.0}, 
  {year: 2003.0, month: '2003-03', 'product': 'Classic Cars', 'region': 'EMEA', 'country': 'UK', 'size': 'Medium', 'status': 'Shipped', 'sales': 18429.45, 'profit': 6450.31, 'orders': 5, 'daysToShip': 4.4}, 
  {year: 2003.0, month: '2003-03', 'product': 'Classic Cars', 'region': 'Japan', 'country': 'Philippines', 'size': 'Medium', 'status': 'Shipped', 'sales': 29316.64, 'profit': 10260.82, 'orders': 8, 'daysToShip': 3.9}, 
  {year: 2003.0, month: '2003-03', 'product': 'Classic Cars', 'region': 'Japan', 'country': 'Philippines', 'size': 'Small', 'status': 'Shipped', 'sales': 5799.21, 'profit': 2029.72, 'orders': 3, 'daysToShip': 5.0}, 
  {year: 2003.0, month: '2003-03', 'product': 'Classic Cars', 'region': 'EMEA', 'country': 'UK', 'size': 'Small', 'status': 'Shipped', 'sales': 6283.65, 'profit': 2199.28, 'orders': 3, 'daysToShip': 3.7}, 
  {year: 2003.0, month: '2003-03', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 7600.0, 'profit': 2660.0, 'orders': 3, 'daysToShip': 7.0}, 
  {year: 2003.0, month: '2003-03', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 4643.01, 'profit': 1625.05, 'orders': 3, 'daysToShip': 2.7}, 
  {year: 2003.0, month: '2003-03', 'product': 'Motorcycles', 'region': 'Japan', 'country': 'Philippines', 'size': 'Medium', 'status': 'Shipped', 'sales': 3100.0, 'profit': 1085.0, 'orders': 1, 'daysToShip': 6.0}, 
  {year: 2003.0, month: '2003-03', 'product': 'Motorcycles', 'region': 'Japan', 'country': 'Philippines', 'size': 'Small', 'status': 'Shipped', 'sales': 8969.37, 'profit': 3139.28, 'orders': 4, 'daysToShip': 3.8}, 
  {year: 2003.0, month: '2003-03', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Large', 'status': 'Shipped', 'sales': 17900.0, 'profit': 6265.0, 'orders': 4, 'daysToShip': 3.2}, 
  {year: 2003.0, month: '2003-04', 'product': 'Ships', 'region': 'Japan', 'country': 'Singapore', 'size': 'Small', 'status': 'Shipped', 'sales': 2184.0, 'profit': 764.4, 'orders': 1, 'daysToShip': 3.0}, 
  {year: 2003.0, month: '2003-04', 'product': 'Planes', 'region': 'EMEA', 'country': 'Austria', 'size': 'Small', 'status': 'Shipped', 'sales': 7300.2, 'profit': 2555.07, 'orders': 4, 'daysToShip': 2.8}, 
  {year: 2003.0, month: '2003-04', 'product': 'Ships', 'region': 'EMEA', 'country': 'Austria', 'size': 'Small', 'status': 'Shipped', 'sales': 9024.73, 'profit': 3158.66, 'orders': 4, 'daysToShip': 2.8}, 
  {year: 2003.0, month: '2003-04', 'product': 'Ships', 'region': 'EMEA', 'country': 'Spain', 'size': 'Medium', 'status': 'Shipped', 'sales': 3600.0, 'profit': 1260.0, 'orders': 1, 'daysToShip': 4.0}, 
  {year: 2003.0, month: '2003-04', 'product': 'Ships', 'region': 'Japan', 'country': 'Singapore', 'size': 'Medium', 'status': 'Shipped', 'sales': 10881.74, 'profit': 3808.61, 'orders': 3, 'daysToShip': 4.3}, 
  {year: 2003.0, month: '2003-04', 'product': 'Trains', 'region': 'Japan', 'country': 'Singapore', 'size': 'Small', 'status': 'Shipped', 'sales': 3045.21, 'profit': 1065.82, 'orders': 2, 'daysToShip': 2.5}, 
  {year: 2003.0, month: '2003-04', 'product': 'Vintage Cars', 'region': 'Japan', 'country': 'Singapore', 'size': 'Medium', 'status': 'Shipped', 'sales': 2600.0, 'profit': 910.0, 'orders': 1, 'daysToShip': 4.0}, 
  {year: 2003.0, month: '2003-04', 'product': 'Trucks and Buses', 'region': 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 2700.0, 'profit': 945.0, 'orders': 1, 'daysToShip': 2.0}, 
  {year: 2003.0, month: '2003-04', 'product': 'Vintage Cars', 'region': 'APAC', 'country': 'Australia', 'size': 'Small', 'status': 'Shipped', 'sales': 4575.05, 'profit': 1601.27, 'orders': 2, 'daysToShip': 3.5}, 
  {year: 2003.0, month: '2003-04', 'product': 'Vintage Cars', 'region': 'EMEA', 'country': 'Austria', 'size': 'Medium', 'status': 'Shipped', 'sales': 6236.65, 'profit': 2182.83, 'orders': 2, 'daysToShip': 4.0}, 
  {year: 2003.0, month: '2003-04', 'product': 'Vintage Cars', 'region': 'EMEA', 'country': 'Austria', 'size': 'Small', 'status': 'Shipped', 'sales': 4146.64, 'profit': 1451.32, 'orders': 2, 'daysToShip': 6.0}, 
  {year: 2003.0, month: '2003-04', 'product': 'Planes', 'region': 'EMEA', 'country': 'Austria', 'size': 'Medium', 'status': 'Shipped', 'sales': 4300.0, 'profit': 1505.0, 'orders': 1, 'daysToShip': 3.0}, 
  {year: 2003.0, month: '2003-04', 'product': 'Vintage Cars', 'region': 'Japan', 'country': 'Singapore', 'size': 'Small', 'status': 'Shipped', 'sales': 2240.66, 'profit': 784.23, 'orders': 1, 'daysToShip': 7.0}, 
  {year: 2003.0, month: '2003-04', 'product': 'Trucks and Buses', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 4600.0, 'profit': 1610.0, 'orders': 1, 'daysToShip': 1.0}, 
  {year: 2003.0, month: '2003-04', 'product': 'Planes', 'region': 'APAC', 'country': 'Australia', 'size': 'Medium', 'status': 'Shipped', 'sales': 13431.87, 'profit': 4701.15, 'orders': 4, 'daysToShip': 6.0}, 
  {year: 2003.0, month: '2003-04', 'product': 'Planes', 'region': 'APAC', 'country': 'Australia', 'size': 'Small', 'status': 'Shipped', 'sales': 6961.7, 'profit': 2436.6, 'orders': 3, 'daysToShip': 5.0}, 
  {year: 2003.0, month: '2003-04', 'product': 'Classic Cars', 'region': 'APAC', 'country': 'Australia', 'size': 'Small', 'status': 'Shipped', 'sales': 8539.62, 'profit': 2988.87, 'orders': 4, 'daysToShip': 3.5}, 
  {year: 2003.0, month: '2003-04', 'product': 'Classic Cars', 'region': 'APAC', 'country': 'Australia', 'size': 'Medium', 'status': 'Shipped', 'sales': 9900.0, 'profit': 3465.0, 'orders': 3, 'daysToShip': 4.0}, 
  {year: 2003.0, month: '2003-04', 'product': 'Motorcycles', 'region': 'APAC', 'country': 'Australia', 'size': 'Small', 'status': 'Shipped', 'sales': 16968.2, 'profit': 5938.87, 'orders': 7, 'daysToShip': 5.0}, 
  {year: 2003.0, month: '2003-04', 'product': 'Classic Cars', 'region': 'EMEA', 'country': 'Austria', 'size': 'Medium', 'status': 'Shipped', 'sales': 16800.0, 'profit': 5880.0, 'orders': 4, 'daysToShip': 4.2}, 
  {year: 2003.0, month: '2003-04', 'product': 'Classic Cars', 'region': 'EMEA', 'country': 'Austria', 'size': 'Small', 'status': 'Shipped', 'sales': 1262.8, 'profit': 441.98, 'orders': 1, 'daysToShip': 2.0}, 
  {year: 2003.0, month: '2003-04', 'product': 'Classic Cars', 'region': 'EMEA', 'country': 'France', 'size': 'Large', 'status': 'Shipped', 'sales': 4100.0, 'profit': 1435.0, 'orders': 1, 'daysToShip': 7.0}, 
  {year: 2003.0, month: '2003-04', 'product': 'Classic Cars', 'region': 'EMEA', 'country': 'Germany', 'size': 'Medium', 'status': 'Shipped', 'sales': 16149.6, 'profit': 5652.36, 'orders': 5, 'daysToShip': 3.8}, 
  {year: 2003.0, month: '2003-04', 'product': 'Classic Cars', 'region': 'EMEA', 'country': 'France', 'size': 'Medium', 'status': 'Shipped', 'sales': 6100.0, 'profit': 2135.0, 'orders': 2, 'daysToShip': 2.5}, 
  {year: 2003.0, month: '2003-04', 'product': 'Classic Cars', 'region': 'Japan', 'country': 'Singapore', 'size': 'Medium', 'status': 'Shipped', 'sales': 11500.0, 'profit': 4025.0, 'orders': 3, 'daysToShip': 4.0}, 
  {year: 2003.0, month: '2003-04', 'product': 'Classic Cars', 'region': 'Japan', 'country': 'Singapore', 'size': 'Small', 'status': 'Shipped', 'sales': 2200.0, 'profit': 770.0, 'orders': 1, 'daysToShip': 6.0}, 
  {year: 2003.0, month: '2003-04', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Large', 'status': 'Shipped', 'sales': 4600.0, 'profit': 1610.0, 'orders': 1, 'daysToShip': 1.0}, 
  {year: 2003.0, month: '2003-04', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 7659.92, 'profit': 2680.97, 'orders': 2, 'daysToShip': 3.0}, 
  {year: 2003.0, month: '2003-04', 'product': 'Motorcycles', 'region': 'APAC', 'country': 'Australia', 'size': 'Large', 'status': 'Shipped', 'sales': 4600.0, 'profit': 1610.0, 'orders': 1, 'daysToShip': 5.0}, 
  {year: 2003.0, month: '2003-04', 'product': 'Motorcycles', 'region': 'APAC', 'country': 'Australia', 'size': 'Medium', 'status': 'Shipped', 'sales': 14198.15, 'profit': 4969.35, 'orders': 4, 'daysToShip': 3.5}, 
  {year: 2003.0, month: '2003-04', 'product': 'Classic Cars', 'region': 'EMEA', 'country': 'Germany', 'size': 'Small', 'status': 'Shipped', 'sales': 5807.6, 'profit': 2032.66, 'orders': 3, 'daysToShip': 3.3}, 
  {year: 2003.0, month: '2003-05', 'product': 'Vintage Cars', 'region': 'APAC', 'country': 'Australia', 'size': 'Medium', 'status': 'Shipped', 'sales': 6600.0, 'profit': 2310.0, 'orders': 2, 'daysToShip': 4.5}, 
  {year: 2003.0, month: '2003-05', 'product': 'Trucks and Buses', 'region': 'EMEA', 'country': 'Spain', 'size': 'Small', 'status': 'Shipped', 'sales': 6526.06, 'profit': 2284.12, 'orders': 3, 'daysToShip': 1.0}, 
  {year: 2003.0, month: '2003-05', 'product': 'Trucks and Buses', 'region': 'NA', 'country': 'Canada', 'size': 'Medium', 'status': 'Shipped', 'sales': 6200.0, 'profit': 2170.0, 'orders': 2, 'daysToShip': 4.5}, 
  {year: 2003.0, month: '2003-05', 'product': 'Trucks and Buses', 'region': 'NA', 'country': 'Canada', 'size': 'Small', 'status': 'Shipped', 'sales': 2117.52, 'profit': 741.13, 'orders': 1, 'daysToShip': 6.0}, 
  {year: 2003.0, month: '2003-05', 'product': 'Vintage Cars', 'region': 'EMEA', 'country': 'Italy', 'size': 'Medium', 'status': 'Shipped', 'sales': 12000.0, 'profit': 4200.0, 'orders': 4, 'daysToShip': 2.5}, 
  {year: 2003.0, month: '2003-05', 'product': 'Trucks and Buses', 'region': 'EMEA', 'country': 'Spain', 'size': 'Medium', 'status': 'Shipped', 'sales': 10641.33, 'profit': 3724.47, 'orders': 3, 'daysToShip': 4.3}, 
  {year: 2003.0, month: '2003-05', 'product': 'Vintage Cars', 'region': 'EMEA', 'country': 'Spain', 'size': 'Medium', 'status': 'Shipped', 'sales': 9919.12, 'profit': 3471.69, 'orders': 3, 'daysToShip': 3.3}, 
  {year: 2003.0, month: '2003-05', 'product': 'Vintage Cars', 'region': 'EMEA', 'country': 'Spain', 'size': 'Small', 'status': 'Shipped', 'sales': 10341.24, 'profit': 3619.43, 'orders': 4, 'daysToShip': 5.2}, 
  {year: 2003.0, month: '2003-05', 'product': 'Vintage Cars', 'region': 'NA', 'country': 'Canada', 'size': 'Medium', 'status': 'Shipped', 'sales': 9550.16, 'profit': 3342.56, 'orders': 3, 'daysToShip': 3.3}, 
  {year: 2003.0, month: '2003-05', 'product': 'Vintage Cars', 'region': 'NA', 'country': 'Canada', 'size': 'Small', 'status': 'Shipped', 'sales': 5453.21, 'profit': 1908.62, 'orders': 3, 'daysToShip': 3.7}, 
  {year: 2003.0, month: '2003-05', 'product': 'Vintage Cars', 'region': 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 8589.84, 'profit': 3006.44, 'orders': 5, 'daysToShip': 3.4}, 
  {year: 2003.0, month: '2003-05', 'product': 'Vintage Cars', 'region': 'EMEA', 'country': 'Italy', 'size': 'Small', 'status': 'Shipped', 'sales': 17680.85, 'profit': 6188.3, 'orders': 10, 'daysToShip': 3.8}, 
  {year: 2003.0, month: '2003-05', 'product': 'Trucks and Buses', 'region': 'EMEA', 'country': 'Spain', 'size': 'Large', 'status': 'Shipped', 'sales': 5000.0, 'profit': 1750.0, 'orders': 1, 'daysToShip': 7.0}, 
  {year: 2003.0, month: '2003-05', 'product': 'Vintage Cars', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 7281.24, 'profit': 2548.43, 'orders': 2, 'daysToShip': 3.5}, 
  {year: 2003.0, month: '2003-05', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 34396.77, 'profit': 12038.87, 'orders': 9, 'daysToShip': 3.7}, 
  {year: 2003.0, month: '2003-05', 'product': 'Classic Cars', 'region': 'EMEA', 'country': 'France', 'size': 'Medium', 'status': 'Shipped', 'sales': 10600.0, 'profit': 3710.0, 'orders': 3, 'daysToShip': 6.3}, 
  {year: 2003.0, month: '2003-05', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 28262.72, 'profit': 9891.95, 'orders': 15, 'daysToShip': 4.3}, 
  {year: 2003.0, month: '2003-05', 'product': 'Classic Cars', 'region': 'EMEA', 'country': 'France', 'size': 'Small', 'status': 'Shipped', 'sales': 2993.5, 'profit': 1047.72, 'orders': 1, 'daysToShip': 1.0}, 
  {year: 2003.0, month: '2003-05', 'product': 'Classic Cars', 'region': 'EMEA', 'country': 'Norway', 'size': 'Large', 'status': 'Shipped', 'sales': 9700.0, 'profit': 3395.0, 'orders': 2, 'daysToShip': 5.5}, 
  {year: 2003.0, month: '2003-05', 'product': 'Classic Cars', 'region': 'EMEA', 'country': 'Norway', 'size': 'Medium', 'status': 'Shipped', 'sales': 15300.0, 'profit': 5355.0, 'orders': 5, 'daysToShip': 3.0}, 
  {year: 2003.0, month: '2003-05', 'product': 'Classic Cars', 'region': 'EMEA', 'country': 'Norway', 'size': 'Small', 'status': 'Shipped', 'sales': 6843.0, 'profit': 2395.05, 'orders': 4, 'daysToShip': 2.0},
  {year: 2003.0, month: '2003-05', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Large', 'status': 'Shipped', 'sales': 27829.3, 'profit': 9740.25, 'orders': 6, 'daysToShip': 3.2}, 
  {year: 2003.0, month: '2003-06', 'product': 'Motorcycles', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 8900.0, 'profit': 3115.0, 'orders': 2, 'daysToShip': 4.5}, 
  {year: 2003.0, month: '2003-06', 'product': 'Vintage Cars', 'region': 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 1188.0, 'profit': 415.8, 'orders': 1, 'daysToShip': 2.0}, 
  {year: 2003.0, month: '2003-06', 'product': 'Vintage Cars', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 12263.24, 'profit': 4292.13, 'orders': 4, 'daysToShip': 3.2}, 
  {year: 2003.0, month: '2003-06', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 18600.0, 'profit': 6510.0, 'orders': 6, 'daysToShip': 3.7}, 
  {year: 2003.0, month: '2003-06', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Large', 'status': 'Shipped', 'sales': 7500.0, 'profit': 2625.0, 'orders': 1, 'daysToShip': 1.0}, 
  {year: 2003.0, month: '2003-06', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 10223.8, 'profit': 3578.33, 'orders': 4, 'daysToShip': 2.5}, 
  {year: 2003.0, month: '2003-06', 'product': 'Motorcycles', 'region': 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 3378.96, 'profit': 1182.64, 'orders': 1, 'daysToShip': 3.0}, 
  {year: 2003.0, month: '2003-07', 'product': 'Classic Cars', 'region': 'EMEA', 'country': 'France', 'size': 'Medium', 'status': 'Shipped', 'sales': 5200.0, 'profit': 1820.0, 'orders': 1, 'daysToShip': 2.0}, 
  {year: 2003.0, month: '2003-07', 'product': 'Motorcycles', 'region': 'EMEA', 'country': 'France', 'size': 'Small', 'status': 'Shipped', 'sales': 2765.9, 'profit': 968.06, 'orders': 1, 'daysToShip': 6.0}, 
  {year: 2003.0, month: '2003-07', 'product': 'Motorcycles', 'region': 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 3460.2, 'profit': 1211.07, 'orders': 1, 'daysToShip': 4.0}, 
  {year: 2003.0, month: '2003-07', 'product': 'Classic Cars', 'region': 'EMEA', 'country': 'France', 'size': 'Small', 'status': 'Shipped', 'sales': 1263.6, 'profit': 442.26, 'orders': 1, 'daysToShip': 5.0}, 
  {year: 2003.0, month: '2003-07', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 23376.93, 'profit': 8181.93, 'orders': 6, 'daysToShip': 3.3}, 
  {year: 2003.0, month: '2003-07', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 6323.96, 'profit': 2213.39, 'orders': 4, 'daysToShip': 3.5}, 
  {year: 2003.0, month: '2003-07', 'product': 'Vintage Cars', 'region': 'EMEA', 'country': 'France', 'size': 'Medium', 'status': 'Shipped', 'sales': 13330.5, 'profit': 4665.67, 'orders': 4, 'daysToShip': 4.2}, 
  {year: 2003.0, month: '2003-07', 'product': 'Vintage Cars', 'region': 'EMEA', 'country': 'France', 'size': 'Small', 'status': 'Shipped', 'sales': 4172.28, 'profit': 1460.3, 'orders': 2, 'daysToShip': 3.5}, 
  {year: 2003.0, month: '2003-08', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 6274.8, 'profit': 2196.18, 'orders': 2, 'daysToShip': 2.0}, 
  {year: 2003.0, month: '2003-08', 'product': 'Vintage Cars', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 9500.0, 'profit': 3325.0, 'orders': 3, 'daysToShip': 4.3}, 
  {year: 2003.0, month: '2003-08', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 14800.0, 'profit': 5180.0, 'orders': 4, 'daysToShip': 3.8}, 
  {year: 2003.0, month: '2003-08', 'product': 'Vintage Cars', 'region': 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 6950.56, 'profit': 2432.7, 'orders': 3, 'daysToShip': 2.7}, 
  {year: 2003.0, month: '2003-08', 'product': 'Motorcycles', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 3746.7, 'profit': 1311.35, 'orders': 1, 'daysToShip': 4.0}, 
  {year: 2003.0, month: '2003-08', 'product': 'Vintage Cars', 'region': 'NA', 'country': 'USA', 'size': 'Large', 'status': 'Shipped', 'sales': 7100.0, 'profit': 2485.0, 'orders': 1, 'daysToShip': 3.0}, 
  {year: 2003.0, month: '2003-09', 'product': 'Vintage Cars', 'region': 'EMEA', 'country': 'Finland', 'size': 'Small', 'status': 'Shipped', 'sales': 2015.28, 'profit': 705.35, 'orders': 1, 'daysToShip': 5.0}, 
  {year: 2003.0, month: '2003-09', 'product': 'Vintage Cars', 'region': 'EMEA', 'country': 'Finland', 'size': 'Medium', 'status': 'Shipped', 'sales': 8964.96, 'profit': 3137.74, 'orders': 3, 'daysToShip': 3.3}, 
  {year: 2003.0, month: '2003-09', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Large', 'status': 'Shipped', 'sales': 15000.0, 'profit': 5250.0, 'orders': 2, 'daysToShip': 2.0}, 
  {year: 2003.0, month: '2003-09', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 21299.31, 'profit': 7454.76, 'orders': 6, 'daysToShip': 3.7}, 
  {year: 2003.0, month: '2003-09', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 2500.0, 'profit': 875.0, 'orders': 1, 'daysToShip': 4.0}, 
  {year: 2003.0, month: '2003-10', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 38293.13, 'profit': 13402.6, 'orders': 12, 'daysToShip': 3.5}, 
  {year: 2003.0, month: '2003-10', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Large', 'status': 'Shipped', 'sales': 8286.72, 'profit': 2900.35, 'orders': 2, 'daysToShip': 3.5}, 
  {year: 2003.0, month: '2003-10', 'product': 'Motorcycles', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 4900.0, 'profit': 1715.0, 'orders': 1, 'daysToShip': 1.0}, 
  {year: 2003.0, month: '2003-10', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 11052.44, 'profit': 3868.35, 'orders': 5, 'daysToShip': 4.4}, 
  {year: 2003.0, month: '2003-10', 'product': 'Vintage Cars', 'region': 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 6926.8, 'profit': 2424.38, 'orders': 4, 'daysToShip': 3.0}, 
  {year: 2003.0, month: '2003-10', 'product': 'Vintage Cars', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 19822.92, 'profit': 6938.02, 'orders': 7, 'daysToShip': 3.9}, 
  {year: 2003.0, month: '2003-11', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Large', 'status': 'Shipped', 'sales': 48000.0, 'profit': 16800.0, 'orders': 6, 'daysToShip': 2.5}, 
  {year: 2003.0, month: '2003-11', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 73030.14, 'profit': 25560.55, 'orders': 22, 'daysToShip': 3.7}, 
  {year: 2003.0, month: '2003-11', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 21034.36, 'profit': 7362.03, 'orders': 8, 'daysToShip': 3.1}, 
  {year: 2003.0, month: '2003-11', 'product': 'Trucks and Buses', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 18500.0, 'profit': 6475.0, 'orders': 6, 'daysToShip': 4.0}, 
  {year: 2003.0, month: '2003-11', 'product': 'Motorcycles', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 16800.0, 'profit': 5880.0, 'orders': 5, 'daysToShip': 3.2}, 
  {year: 2003.0, month: '2003-11', 'product': 'Vintage Cars', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 12500.0, 'profit': 4375.0, 'orders': 4, 'daysToShip': 4.0}, 
  {year: 2003.0, month: '2003-11', 'product': 'Vintage Cars', 'region': 'EMEA', 'country': 'France', 'size': 'Small', 'status': 'Shipped', 'sales': 5200.0, 'profit': 1820.0, 'orders': 2, 'daysToShip': 3.0}, 
  {year: 2003.0, month: '2003-12', 'product': 'Vintage Cars', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 22000.0, 'profit': 7700.0, 'orders': 5, 'daysToShip': 3.2}, 
  {year: 2003.0, month: '2003-12', 'product': 'Classic Cars', 'region': 'NA', 'country': 'Canada', 'size': 'Medium', 'status': 'Shipped', 'sales': 14500.0, 'profit': 5075.0, 'orders': 4, 'daysToShip': 2.8}, 
  {year: 2004.0, month: '2004-01', 'product': 'Classic Cars', 'region': 'EMEA', 'country': 'France', 'size': 'Medium', 'status': 'Shipped', 'sales': 32000.0, 'profit': 11200.0, 'orders': 8, 'daysToShip': 2.0}, 
  {year: 2004.0, month: '2004-01', 'product': 'Motorcycles', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 11000.0, 'profit': 3850.0, 'orders': 3, 'daysToShip': 3.0}, 
  {year: 2004.0, month: '2004-02', 'product': 'Motorcycles', 'region': 'APAC', 'country': 'Australia', 'size': 'Large', 'status': 'Shipped', 'sales': 12000.0, 'profit': 4200.0, 'orders': 2, 'daysToShip': 1.0}, 
  {year: 2004.0, month: '2004-02', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Large', 'status': 'Shipped', 'sales': 24500.0, 'profit': 8575.0, 'orders': 3, 'daysToShip': 2.0}, 
  {year: 2004.0, month: '2004-03', 'product': 'Trucks and Buses', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Resolved', 'sales': 18500.0, 'profit': 6475.0, 'orders': 4, 'daysToShip': 8.0}, 
  {year: 2004.0, month: '2004-03', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 15200.0, 'profit': 5320.0, 'orders': 5, 'daysToShip': 3.5}, 
  {year: 2004.0, month: '2004-04', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Large', 'status': 'Shipped', 'sales': 55000.0, 'profit': 19250.0, 'orders': 7, 'daysToShip': 3.0}, 
  {year: 2004.0, month: '2004-04', 'product': 'Vintage Cars', 'region': 'EMEA', 'country': 'UK', 'size': 'Small', 'status': 'Shipped', 'sales': 4800.0, 'profit': 1680.0, 'orders': 2, 'daysToShip': 2.5}, 
  {year: 2004.0, month: '2004-05', 'product': 'Vintage Cars', 'region': 'EMEA', 'country': 'Spain', 'size': 'Small', 'status': 'Shipped', 'sales': 14000.0, 'profit': 4900.0, 'orders': 3, 'daysToShip': 4.0}, 
  {year: 2004.0, month: '2004-05', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 19800.0, 'profit': 6930.0, 'orders': 6, 'daysToShip': 2.0}, 
  {year: 2004.0, month: '2004-06', 'product': 'Planes', 'region': 'Japan', 'country': 'Japan', 'size': 'Medium', 'status': 'Shipped', 'sales': 28000.0, 'profit': 9800.0, 'orders': 6, 'daysToShip': 2.0}, 
  {year: 2004.0, month: '2004-06', 'product': 'Ships', 'region': 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 5400.0, 'profit': 1890.0, 'orders': 2, 'daysToShip': 3.0}, 
  {year: 2004.0, month: '2004-07', 'product': 'Ships', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 22000.0, 'profit': 7700.0, 'orders': 5, 'daysToShip': 3.0}, 
  {year: 2004.0, month: '2004-08', 'product': 'Classic Cars', 'region': 'EMEA', 'country': 'Italy', 'size': 'Large', 'status': 'Shipped', 'sales': 42000.0, 'profit': 14700.0, 'orders': 5, 'daysToShip': 2.0}, 
  {year: 2004.0, month: '2004-09', 'product': 'Trains', 'region': 'NA', 'country': 'USA', 'size': 'Small', 'status': 'Shipped', 'sales': 9500.0, 'profit': 3325.0, 'orders': 3, 'daysToShip': 1.0}, 
  {year: 2004.0, month: '2004-10', 'product': 'Classic Cars', 'region': 'APAC', 'country': 'Singapore', 'size': 'Medium', 'status': 'Shipped', 'sales': 38000.0, 'profit': 13300.0, 'orders': 8, 'daysToShip': 4.0}, 
  {year: 2004.0, month: '2004-11', 'product': 'Motorcycles', 'region': 'EMEA', 'country': 'France', 'size': 'Large', 'status': 'On Hold', 'sales': 45000.0, 'profit': 15750.0, 'orders': 6, 'daysToShip': 15.0}, 
  {year: 2004.0, month: '2004-11', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Large', 'status': 'Shipped', 'sales': 62000.0, 'profit': 21700.0, 'orders': 7, 'daysToShip': 2.5}, 
  {year: 2004.0, month: '2004-12', 'product': 'Vintage Cars', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Shipped', 'sales': 52000.0, 'profit': 18200.0, 'orders': 10, 'daysToShip': 3.0}, 
  {year: 2005.0, month: '2005-01', 'product': 'Trucks and Buses', 'region': 'EMEA', 'country': 'Spain', 'size': 'Large', 'status': 'Shipped', 'sales': 33000.0, 'profit': 11550.0, 'orders': 5, 'daysToShip': 2.0}, 
  {year: 2005.0, month: '2005-02', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Medium', 'status': 'Disputed', 'sales': 21000.0, 'profit': 7350.0, 'orders': 4, 'daysToShip': 12.0}, 
  {year: 2005.0, month: '2005-03', 'product': 'Motorcycles', 'region': 'APAC', 'country': 'Australia', 'size': 'Small', 'status': 'Shipped', 'sales': 15000.0, 'profit': 5250.0, 'orders': 3, 'daysToShip': 3.0}, 
  {year: 2005.0, month: '2005-04', 'product': 'Ships', 'region': 'EMEA', 'country': 'UK', 'size': 'Medium', 'status': 'Shipped', 'sales': 19000.0, 'profit': 6650.0, 'orders': 4, 'daysToShip': 2.0}, 
  {year: 2005.0, month: '2005-05', 'product': 'Classic Cars', 'region': 'NA', 'country': 'USA', 'size': 'Large', 'status': 'Shipped', 'sales': 62000.0, 'profit': 21700.0, 'orders': 9, 'daysToShip': 2.0}, 
  {year: 2005.0, month: '2005-05', 'product': 'Vintage Cars', 'region': 'EMEA', 'country': 'France', 'size': 'Medium', 'status': 'In Process', 'sales': 28000.0, 'profit': 9800.0, 'orders': 5, 'daysToShip': 0.0}
];

        const CUSTOMERS = [
  {name: 'Euro Shopping Channel', country: 'Spain', sales: 766195.05}, 
  {name: 'Mini Gifts Distributors Ltd.', country: 'USA', sales: 530587.19}, 
  {name: 'Australian Collectors, Co.', country: 'Australia', sales: 164575.87}, 
  {name: 'La Rochelle Gifts', country: 'France', sales: 153909.82}, 
  {name: 'Muscle Machine Inc', country: 'USA', sales: 151782.04}, 
  {name: 'Land of Toys Inc.', country: 'USA', sales: 138798.17}, 
  {name: 'AV Stores, Co.', country: 'UK', sales: 136873.25}, 
  {name: 'The Sharp Gifts Warehouse', country: 'USA', sales: 136383.04}, 
  {name: 'Souveniers And Things Co.', country: 'Australia', sales: 133223.38}, 
  {name: 'Dragon Souveniers, Ltd.', country: 'Singapore', sales: 131279.95}
];

        // --- STATE ---
        let state = {
            filters: { year: 'All', region: 'All', product: 'All', size: 'All' },
            chartType: 'area',
            isAiOpen: false,
            chatHistory: [{role: 'model', text: "VEHICLE SALES AI Online. I have access to your live filtered data. Ready for analysis."}],
            quickActions: [
                { label: "Draft Team Email", icon: "mail", prompt: "Draft a concise email to the sales team summarizing the current KPIs and top product performance." },
                { label: "SWOT Analysis", icon: "shield", prompt: "Perform a brief SWOT analysis based on the current regional and product data." },
                { label: "Predict Q4", icon: "sparkles", prompt: "Based on the current trend data, give a speculative prediction for Q4 performance." }
            ]
        };

        // --- CHARTS ---
        let revenueChart, customerChart, regionChart, productChart;

        // --- INIT ---
        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();
            renderFilters();
            renderQuickActions();
            updateDashboard();
        });
        
        // --- THEME LOGIC ---
        function toggleTheme() {
            document.body.classList.toggle('light-mode');
            const isLight = document.body.classList.contains('light-mode');
            const themeIcon = document.getElementById('themeIcon');
            
            // Update Icon
            themeIcon.setAttribute('data-lucide', isLight ? 'sun' : 'moon');
            lucide.createIcons();

            // Update Charts
            const mode = isLight ? 'light' : 'dark';
            if(revenueChart) revenueChart.updateOptions({ theme: { mode: mode } });
            if(customerChart) customerChart.updateOptions({ theme: { mode: mode } });
            
            // Region and Product charts need more granular text update as Apex doesn't auto-swap all colors in custom configs
            if(regionChart) regionChart.updateOptions({ theme: { mode: mode } });
            if(productChart) productChart.updateOptions({ theme: { mode: mode } });
        }

        // --- CORE LOGIC ---
        function getFilteredData() {
            return RAW_DATA.filter(item => {
                const matchYear = state.filters.year === 'All' || item.year.toString() === state.filters.year;
                const matchRegion = state.filters.region === 'All' || item.region === state.filters.region;
                const matchProduct = state.filters.product === 'All' || item.product === state.filters.product;
                const matchSize = state.filters.size === 'All' || item.size === state.filters.size;
                return matchYear && matchRegion && matchProduct && matchSize;
            });
        }

        function updateDashboard() {
            const filtered = getFilteredData();
            updateKPIs(filtered);
            updateCharts(filtered);
            updateLedger(filtered);
            updateFilterUI();
        }

        function updateKPIs(data) {
            const totalSales = data.reduce((a, b) => a + b.sales, 0);
            const totalProfit = data.reduce((a, b) => a + b.profit, 0);
            const totalOrders = data.reduce((a, b) => a + b.orders, 0);
            
            const validShipping = data.filter(d => d.status === 'Shipped');
            const avgDays = validShipping.length > 0 
                ? (validShipping.reduce((a, b) => a + b.daysToShip, 0) / validShipping.length).toFixed(1) 
                : 0;

            const kpiHTML = `
                ${renderKPICard("Total Revenue", formatCurrency(totalSales), "dollar-sign", 0, "Lifetime Volume", "up", 85)}
                ${renderKPICard("Net Profit", formatCurrency(totalProfit), "target", 1, "Calculated Margin", "up", 75)}
                ${renderKPICard("Avg Fulfillment", avgDays + " Days", "clock", 2, "Order to Ship Time", avgDays < 3 ? "up" : "down", 95)}
                ${renderKPICard("Total Orders", totalOrders.toLocaleString(), "shopping-cart", 3, "Processed", "up", 62)}
            `;
            document.getElementById('kpiGrid').innerHTML = kpiHTML;
            lucide.createIcons();
        }

        function renderKPICard(title, value, icon, colorIdx, subtext, trend, target) {
            const colors = [
                "from-fuchsia-500 to-pink-600", "from-blue-500 to-indigo-600", "from-cyan-400 to-blue-500", "from-emerald-400 to-teal-500"
            ];
            const gradient = colors[colorIdx % colors.length];
            
            return `
            <div class="relative overflow-hidden glass-panel rounded-2xl p-6 group hover:border-white/20 transition-all duration-500 hover:shadow-[0_0_40px_rgba(0,0,0,0.5)] hover:-translate-y-1">
                <div class="absolute inset-0 bg-gradient-to-br ${gradient} opacity-0 group-hover:opacity-10 transition-opacity duration-500"></div>
                <div class="flex justify-between items-start mb-4 relative z-10">
                    <div>
                        <p class="text-slate-400 text-[10px] font-bold tracking-[0.2em] uppercase mb-1">${title}</p>
                        <h3 class="text-2xl lg:text-3xl font-black text-transparent bg-clip-text bg-gradient-to-r from-white to-slate-300 group-hover:scale-105 transition-transform duration-300 origin-left">${value}</h3>
                    </div>
                    <div class="p-3 rounded-xl bg-gradient-to-br ${gradient} shadow-lg"><i data-lucide="${icon}" class="w-5 h-5 text-white"></i></div>
                </div>
                <div class="space-y-3 relative z-10">
                    <div class="w-full bg-slate-800/80 rounded-full h-1.5 overflow-hidden backdrop-blur-sm">
                        <div class="h-full rounded-full bg-gradient-to-r ${gradient}" style="width: ${Math.min(target, 100)}%"></div>
                    </div>
                    <div class="flex items-center justify-between pt-1">
                        <span class="text-[10px] text-slate-500 font-mono tracking-wide uppercase">${subtext}</span>
                        <div class="flex items-center text-xs font-bold px-2 py-0.5 rounded-full bg-black/30 ${trend === 'up' ? 'text-emerald-400 border border-emerald-500/30' : 'text-rose-400 border border-rose-500/30'}">
                            <i data-lucide="${trend === 'up' ? 'trending-up' : 'trending-down'}" class="w-3 h-3 mr-1"></i>
                            ${trend === 'up' ? '+12.5%' : '-2.4%'}
                        </div>
                    </div>
                </div>
            </div>`;
        }

        // --- CHARTS ---
        function updateCharts(data) {
            // 1. Revenue Trend
            const trendAgg = {};
            data.forEach(d => trendAgg[d.month] = (trendAgg[d.month] || 0) + d.sales);
            const trendSeries = Object.entries(trendAgg).sort().map(([x, y]) => ({x, y}));
            const currentTheme = document.body.classList.contains('light-mode') ? 'light' : 'dark';
            
            const areaOptions = {
                series: [{ name: 'Revenue', data: trendSeries }],
                chart: { 
                    type: state.chartType, 
                    height: 350, 
                    background: 'transparent', 
                    toolbar: { show: false },
                    animations: { enabled: true }
                },
                theme: { mode: currentTheme },
                stroke: { curve: 'smooth', width: 3 },
                fill: {
                    type: 'gradient',
                    gradient: { shadeIntensity: 1, opacityFrom: 0.7, opacityTo: 0.1, stops: [0, 90, 100] }
                },
                colors: ['#d946ef'],
                dataLabels: { enabled: false },
                grid: { borderColor: '#334155', strokeDashArray: 4 },
                xaxis: { type: 'category', labels: { style: { colors: '#94a3b8', fontFamily: 'JetBrains Mono' } }, axisBorder: { show: false }, axisTicks: { show: false } },
                yaxis: { labels: { style: { colors: '#94a3b8', fontFamily: 'JetBrains Mono' }, formatter: (val) => "$" + (val/1000).toFixed(0) + "k" } }
            };

            if (!revenueChart) {
                revenueChart = new ApexCharts(document.querySelector("#revenueChart"), areaOptions);
                revenueChart.render();
            } else {
                revenueChart.updateOptions({ ...areaOptions, chart: { type: state.chartType, background: 'transparent', toolbar: { show: false }, animations: { enabled: true } } });
            }

            // 2. Customers (Bar)
            const custSeries = CUSTOMERS.map(c => ({ x: c.name, y: c.sales }));
            
            const barOptions = {
                series: [{ name: 'Sales', data: custSeries }],
                chart: { type: 'bar', height: 200, background: 'transparent', toolbar: { show: false } },
                plotOptions: { bar: { borderRadius: 4, horizontal: true, barHeight: '50%' } },
                colors: ['#8b5cf6'],
                dataLabels: { enabled: false },
                grid: { show: false },
                xaxis: { labels: { show: false }, axisBorder: { show: false }, axisTicks: { show: false } },
                yaxis: { labels: { style: { colors: '#94a3b8', fontSize: '10px' }, maxWidth: 100 } },
                theme: { mode: currentTheme }
            };
            if (!customerChart) {
                customerChart = new ApexCharts(document.querySelector("#customerChart"), barOptions);
                customerChart.render();
            } else {
                customerChart.updateOptions({ theme: { mode: currentTheme } });
                customerChart.updateSeries([{data: custSeries}]);
            }

            // 3. Region (Donut)
            const regAgg = {};
            data.forEach(d => regAgg[d.region] = (regAgg[d.region] || 0) + d.sales);
            const regLabels = Object.keys(regAgg);
            const regSeries = Object.values(regAgg);

            const pieOptions = {
                series: regSeries,
                labels: regLabels,
                chart: { 
                    type: 'donut', 
                    height: 220, 
                    background: 'transparent',
                    events: {
                        dataPointSelection: (event, chartContext, config) => {
                            const selectedRegion = config.w.config.labels[config.dataPointIndex];
                            setFilter('region', selectedRegion);
                        }
                    }
                },
                theme: { mode: currentTheme },
                stroke: { show: false },
                colors: ['#3b82f6', '#8b5cf6', '#ec4899', '#10b981'],
                legend: { position: 'right', labels: { colors: '#94a3b8' } },
                dataLabels: { enabled: false },
                plotOptions: { pie: { donut: { size: '70%' } } }
            };
            if (!regionChart) {
                regionChart = new ApexCharts(document.querySelector("#regionChart"), pieOptions);
                regionChart.render();
            } else {
                regionChart.updateOptions({ labels: regLabels, theme: { mode: currentTheme } });
                regionChart.updateSeries(regSeries);
            }

            // 4. Product (Donut)
            const prodAgg = {};
            data.forEach(d => prodAgg[d.product] = (prodAgg[d.product] || 0) + d.sales);
            const prodLabels = Object.keys(prodAgg);
            const prodSeries = Object.values(prodAgg);

            const prodOptions = {
                series: prodSeries,
                labels: prodLabels,
                chart: { 
                    type: 'donut', 
                    height: 280, 
                    background: 'transparent',
                    events: {
                        dataPointSelection: (event, chartContext, config) => {
                            const selectedProduct = config.w.config.labels[config.dataPointIndex];
                            setFilter('product', selectedProduct);
                        }
                    }
                },
                theme: { mode: currentTheme },
                stroke: { show: false },
                colors: ['#f43f5e', '#8b5cf6', '#06b6d4', '#10b981', '#eab308'],
                legend: { position: 'right', labels: { colors: '#94a3b8' } },
                dataLabels: { enabled: false },
                plotOptions: { pie: { donut: { size: '60%' } } }
            };
            if (!productChart) {
                productChart = new ApexCharts(document.querySelector("#productChart"), prodOptions);
                productChart.render();
            } else {
                productChart.updateOptions({ labels: prodLabels, theme: { mode: currentTheme } });
                productChart.updateSeries(prodSeries);
            }
        }

        // --- LEDGER ---
        function updateLedger(data) {
            const tbody = document.getElementById('ledgerBody');
            const countBadge = document.getElementById('recordCount');
            countBadge.innerText = `${data.length} RECORDS`;
            
            // Show first 50 rows max for performance
            const rows = data.slice(0, 50).map((row, i) => `
                <tr class="group hover:bg-white/5 transition-colors border-b border-slate-800/30 last:border-0">
                    <td class="py-3 pl-2 text-slate-400 font-mono text-xs">${row.month}</td>
                    <td class="py-3 font-medium text-white">${row.product}</td>
                    <td class="py-3">
                        <span class="px-2 py-0.5 rounded text-[10px] font-bold font-mono uppercase 
                            ${row.region === 'NA' ? 'bg-blue-500/10 text-blue-400 border border-blue-500/20' : 
                              row.region === 'EMEA' ? 'bg-purple-500/10 text-purple-400 border border-purple-500/20' : 
                              'bg-yellow-500/10 text-yellow-400 border border-yellow-500/20'}">
                            ${row.region}
                        </span>
                    </td>
                    <td class="py-3 text-right font-mono tracking-tight">${formatCurrency(row.sales)}</td>
                    <td class="py-3 text-right font-mono tracking-tight text-emerald-400">${formatCurrency(row.profit)}</td>
                    <td class="py-3 text-right">
                        <span class="text-[10px] uppercase font-bold px-2 py-0.5 rounded border 
                            ${row.status === 'Shipped' ? 'bg-emerald-500/10 text-emerald-400 border-emerald-500/20' : 
                              row.status === 'Cancelled' ? 'bg-red-500/10 text-red-400 border-red-500/20' : 
                              'bg-orange-500/10 text-orange-400 border-orange-500/20'}">
                            ${row.status}
                        </span>
                    </td>
                    <td class="py-3 pr-2 text-right">
                        <button onclick="analyzeRow(${i})" class="p-1.5 bg-slate-800 hover:bg-fuchsia-600/20 hover:text-fuchsia-400 text-slate-500 rounded-md transition-all">
                            <i data-lucide="microscope" class="w-3 h-3"></i>
                        </button>
                    </td>
                </tr>
                <tr id="insight-${i}" class="hidden bg-indigo-950/20 border-b border-indigo-500/20 animate-in fade-in slide-in-from-top-2">
                    <td colspan="7" class="p-3">
                        <div class="flex items-start gap-3 text-xs">
                            <i data-lucide="sparkles" class="w-4 h-4 text-indigo-400 mt-0.5 flex-shrink-0"></i>
                            <div class="text-indigo-200">
                                <span class="font-bold text-indigo-400 uppercase tracking-wider text-[10px] block mb-1">Nexus Intel:</span>
                                <span id="insight-text-${i}">Loading analysis...</span>
                            </div>
                        </div>
                    </td>
                </tr>
            `).join('');
            
            tbody.innerHTML = rows;
            lucide.createIcons();
        }

        // --- FILTERING UI ---
        function renderFilters() {
            // Inject buttons
            const years = ['All', '2003', '2004', '2005'];
            document.getElementById('yearFilters').innerHTML = years.map(y => createFilterBtn('year', y)).join('');
            
            const regions = ['All', 'NA', 'EMEA', 'APAC', 'Japan'];
            document.getElementById('regionFilters').innerHTML = regions.map(r => createFilterBtn('region', r)).join('');

            const sizes = ['All', 'Small', 'Medium', 'Large'];
            document.getElementById('sizeFilters').innerHTML = sizes.map(s => createFilterBtn('size', s)).join('');

            document.getElementById('productFilters').innerHTML = createFilterBtn('product', 'All');
        }

        function createFilterBtn(key, value) {
            const isActive = state.filters[key] === value;
            const activeClass = "bg-fuchsia-500/20 border-fuchsia-500 text-white shadow-[0_0_10px_rgba(192,38,211,0.3)]";
            const inactiveClass = "bg-white/5 border-transparent text-slate-400 hover:bg-white/10 hover:text-white";
            
            return `<button onclick="setFilter('${key}', '${value}')" 
                class="px-3 py-1.5 text-xs font-medium rounded-md transition-all border ${isActive ? activeClass : inactiveClass}">
                ${value}
            </button>`;
        }

        function setFilter(key, value) {
            state.filters[key] = value;
            renderFilters();
            updateDashboard();
        }

        function resetFilters() {
            state.filters = { year: 'All', region: 'All', product: 'All', size: 'All' };
            renderFilters();
            updateDashboard();
        }

        function toggleFilters() {
            const panel = document.getElementById('filterPanel');
            const btn = document.getElementById('filterBtn');
            if (panel.style.maxHeight) {
                panel.style.maxHeight = null;
                panel.style.opacity = 0;
                btn.classList.remove('bg-fuchsia-600/20', 'border-fuchsia-500', 'text-fuchsia-200');
            } else {
                panel.style.maxHeight = "300px";
                panel.style.opacity = 1;
                btn.classList.add('bg-fuchsia-600/20', 'border-fuchsia-500', 'text-fuchsia-200');
            }
        }

        function updateFilterUI() {
            const indicator = document.getElementById('activeFilterIndicator');
            const hasFilters = Object.values(state.filters).some(v => v !== 'All');
            indicator.classList.toggle('hidden', !hasFilters);
        }

        // --- AI & MODALS ---
        function toggleAI() {
            const sidebar = document.getElementById('aiSidebar');
            state.isAiOpen = !state.isAiOpen;
            if (state.isAiOpen) {
                sidebar.classList.remove('translate-x-full');
            } else {
                sidebar.classList.add('translate-x-full');
            }
        }

        function renderQuickActions() {
            const container = document.getElementById('quickActions');
            container.innerHTML = state.quickActions.map(action => `
                <button onclick="handleAiSend('${action.prompt.replace(/'/g, "\\'")}')" 
                    class="flex items-center whitespace-nowrap bg-slate-800/50 hover:bg-fuchsia-900/30 border border-slate-700 hover:border-fuchsia-500/50 rounded-full px-3 py-1 text-xs text-slate-300 transition-all">
                    <i data-lucide="${action.icon}" class="w-3 h-3 mr-1"></i> ${action.label}
                </button>
            `).join('');
            lucide.createIcons();
        }

        async function handleAiSend(text = null) {
            const input = document.getElementById('aiInput');
            const query = text || input.value;
            if (!query.trim()) return;

            // Add user msg
            addChatMessage('user', query);
            input.value = '';

            // Simulate loading
            const loadingId = addChatMessage('model', 'Thinking...', true);

            try {
                const apiKey = API_KEY; // Runtime Provided
                const context = JSON.stringify(state.filters); // Minimal context to save tokens
                const prompt = `You are Nexus AI. Context: Filters=${context}. User: ${query}`;
                
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                });
                
                const data = await response.json();
                const reply = data.candidates?.[0]?.content?.parts?.[0]?.text || "Error connecting to AI.";
                
                // Remove loading, add real msg
                document.getElementById(loadingId).remove();
                addChatMessage('model', reply);

            } catch (e) {
                document.getElementById(loadingId).innerText = "Connection Error.";
            }
        }

        function addChatMessage(role, text, isLoading = false) {
            const container = document.getElementById('chatHistory');
            const id = 'msg-' + Date.now();
            const align = role === 'user' ? 'justify-end' : 'justify-start';
            const bg = role === 'user' ? 'bg-fuchsia-900/20 border-fuchsia-500/30 text-fuchsia-100' : 'bg-slate-800/50 border-slate-700 text-slate-300';
            
            const html = `
            <div id="${id}" class="flex ${align} animate-in fade-in slide-in-from-bottom-2">
                <div class="max-w-[85%] p-3 rounded-lg border ${bg} ${role === 'user' ? 'rounded-br-none' : 'rounded-bl-none'}">
                    <p class="whitespace-pre-wrap ${isLoading ? 'animate-pulse text-fuchsia-400' : ''}">${text}</p>
                </div>
            </div>`;
            
            container.insertAdjacentHTML('beforeend', html);
            container.scrollTop = container.scrollHeight;
            return id;
        }

        function clearHistory() {
            document.getElementById('chatHistory').innerHTML = '';
        }

        async function toggleReportModal() {
            const modal = document.getElementById('reportModal');
            if (modal.classList.contains('hidden')) {
                modal.classList.remove('hidden');
                setTimeout(() => modal.classList.remove('opacity-0'), 10);
                await generateReport();
            } else {
                modal.classList.add('opacity-0');
                setTimeout(() => modal.classList.add('hidden'), 300);
            }
        }

        async function generateReport() {
            const container = document.getElementById('reportBody');
            container.innerHTML = `
                <div class="flex flex-col items-center justify-center h-full space-y-4 p-8">
                    <div class="w-12 h-12 rounded-full border-4 border-indigo-500/30 border-t-indigo-500 animate-spin"></div>
                    <p class="text-slate-400 animate-pulse">Compiling data & visual intelligence...</p>
                </div>
            `;

            const apiKey = API_KEY; // Runtime Provided
            // Simple prompt for demo
            const prompt = `Generate an HTML executive summary for sales data. Filters: ${JSON.stringify(state.filters)}. Use <h2>, <h3>, <p>, <ul>.`;
            
            // 1. Text
            const textRes = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
            });
            const textData = await textRes.json();
            const reportText = textData.candidates?.[0]?.content?.parts?.[0]?.text || "Report Failed";

            // 2. Image
            const imgPrompt = "Futuristic data dashboard HUD interface, neon blue and purple, dark background, high tech";
            const imgRes = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/imagen-4.0-generate-001:predict?key=${apiKey}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ instances: [{ prompt: imgPrompt }], parameters: { sampleCount: 1 } })
            });
            const imgData = await imgRes.json();
            const imgB64 = imgData.predictions?.[0]?.bytesBase64Encoded;

            container.innerHTML = `
                ${imgB64 ? `<div class="w-full h-48 overflow-hidden relative"><img src="data:image/png;base64,${imgB64}" class="w-full h-full object-cover opacity-80"><div class="absolute inset-0 bg-gradient-to-t from-[#0f172a] to-transparent"></div></div>` : ''}
                <div class="prose prose-invert prose-sm max-w-none p-8 pt-4">
                    ${reportText.replace(/```html/g, '').replace(/```/g, '')}
                </div>
            `;
        }

        async function analyzeRow(index) {
            const row = RAW_DATA[index]; // In real app, map filtered index to raw index
            const rowEl = document.getElementById(`insight-${index}`);
            const textEl = document.getElementById(`insight-text-${index}`);
            
            rowEl.classList.remove('hidden');
            
            const apiKey = API_KEY;
            const prompt = `Analyze sales row: ${JSON.stringify(row)}. 1 sentence risk/opportunity.`;
            
            const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
            });
            const data = await res.json();
            textEl.innerText = data.candidates?.[0]?.content?.parts?.[0]?.text || "Analysis failed.";
        }

        function setChartType(type) {
            state.chartType = type;
            updateDashboard();
            document.getElementById('btnArea').className = type === 'area' ? "p-2 rounded-md transition-all bg-slate-700/80 text-white shadow-md" : "p-2 rounded-md transition-all text-slate-500 hover:text-slate-300";
            document.getElementById('btnBar').className = type === 'bar' ? "p-2 rounded-md transition-all bg-slate-700/80 text-white shadow-md" : "p-2 rounded-md transition-all text-slate-500 hover:text-slate-300";
        }

        function exportCSV() {
            const data = getFilteredData();
            if (!data.length) return;
            const headers = Object.keys(data[0]).join(",");
            const rows = data.map(row => Object.values(row).join(","));
            const csvContent = "data:text/csv;charset=utf-8," + [headers, ...rows].join("\n");
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", `nexus_report_${new Date().toISOString().slice(0,10)}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function copyReport() {
            // Implement copy logic
            alert("Report text copied to clipboard");
        }

        function formatCurrency(val) {
            return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 0 }).format(val);
        }

    </script>
</body>
</html>